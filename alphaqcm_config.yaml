# AlphaQCM 系统超参数配置文件
# 用户可以在此文件中修改所有超参数，无需修改代码

# ============================================================================
# RL训练配置
# ============================================================================
training:
  # 模型选择: qrdqn, iqn, fqf
  model: "iqn"

  # 随机种子
  seed: 0

  # 因子池容量 (推荐: 20-50)
  pool_capacity: 30

  # 标准差参数
  std_lam: 1.0

# ============================================================================
# AlphaPool 配置 (因子池管理)
# ============================================================================
alpha_pool:
  # 是否启用因子池淘汰 (true: 淘汰到baseline, false: 保留所有高质量因子)
  enable_culling: false

  # 淘汰方法 (当enable_culling=true时)
  # 'ic_drop': 基于IC影响淘汰
  # 'weight': 基于权重淘汰
  # 'combined': 综合权重和IC影响
  culling_method: "ic_drop"

  # 是否使用LightGBM评估 (实时奖励计算)
  # true: 每次都用LGB评估整个池子 (准确但慢)
  # false: 使用单因子IC + 周期性重新评估 (快但稍不准确)
  use_lgb_evaluation: false

  # 重新评估周期 (多少个因子后重新评估暂存池)
  reeval_cycle: 1000

  # q5提升阈值 (bps, 暂存因子重新评估时的提升要求)
  reeval_q5_threshold: 0.5

# ============================================================================
# AlphaEnv 配置 (RL环境)
# ============================================================================
environment:
  # 是否打印生成的表达式
  print_expr: true

  # 奖励权重
  intermediate_weight: 0.3
  final_weight: 1.0

# ============================================================================
# 数据配置
# ============================================================================
data:
  # 数据日期范围
  start_date: "20200101"
  end_date: "20200105"

  # 收益率数据路径 (相对于工作目录)
  returns_data_root: "./returns"

  # 因子缓存目录
  factor_cache_dir: "factor_cache"

  # 返回率缓存目录
  return_cache_dir: "return_cache"

  # 时间聚合配置 (影响回看时间计算)
  # 1dper1d: 日频数据，每日聚合
  # 30per5: 30分钟间隔，每5分钟聚合
  # 5per5: 5分钟间隔，每5分钟聚合
  frequency_config: "1dper1d"

# ============================================================================
# Lorentz 计算引擎配置
# ============================================================================
lorentz:
  # Lorentz可执行文件路径
  executable_path: "/dfs/dataset/365-1734663142170/data/Lorentz_History-Insider"

  # 计算线程数
  thread_num: 8

  # 基础数据目录 (自动基于frequency_config生成)
  # 如果需要自定义，可以设置以下路径:

  # 间隔配置文件路径 (自动生成)
  # interval_json: "/path/to/interval.json"

  # 基础字段数据目录 (自动生成)
  # data_root_dir: "/path/to/data"

  # 因子输出目录 (自动生成)
  # output_factor_root: "/path/to/output"

  # 异常统计输出目录 (自动生成)
  # output_abnormal_root: "/path/to/abnormal"

# ============================================================================
# 系统路径配置
# ============================================================================
paths:
  # AlphaQCM数据目录
  alphaqcm_data_dir: "AlphaQCM_data"

  # 日志目录
  logs_dir: "alpha_logs"

  # 因子输出目录
  factors_output_dir: "/dfs/data/Factors"

  # 异常统计目录
  abnormal_stats_dir: "/dfs/data/AbnormalStats"

# ============================================================================
# 算子配置
# ============================================================================
operators:
  # 表达式验证配置
  validation:
    # 最大表达式长度
    max_expr_length: 1000

    # 最大嵌套深度
    max_nesting_depth: 10

    # 允许的算子列表 (自动从算子规则文件加载)
    # allowed_operators: [...]

  # 字段引用配置
  fields:
    # 字段前缀 (如 $Slice.Vol -> @Slice.Vol)
    field_prefix: "@"

# ============================================================================
# 缓存配置
# ============================================================================
cache:
  # 因子缓存过期时间 (小时)
  factor_cache_ttl_hours: 24

  # 返回率缓存过期时间 (小时)
  return_cache_ttl_hours: 24

  # 最大缓存文件大小 (MB)
  max_cache_size_mb: 1000

# ============================================================================
# 调试和日志配置
# ============================================================================
debug:
  # 日志级别: DEBUG, INFO, WARNING, ERROR
  log_level: "INFO"

  # 是否启用性能分析
  enable_profiling: false

  # 是否保存中间结果
  save_intermediate_results: false

  # 最大调试文件大小 (MB)
  max_debug_file_size_mb: 100
